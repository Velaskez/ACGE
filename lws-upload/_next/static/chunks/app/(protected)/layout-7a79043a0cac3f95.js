(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{1926:(e,t,r)=>{"use strict";r.d(t,{q:()=>u});var n=r(2115);function u(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{t(!0)},[]),e}},4324:(e,t,r)=>{Promise.resolve().then(r.bind(r,6041))},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6041:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(5155),u=r(7600),a=r(5695),s=r(2115),o=r(1926);function i(e){let{children:t}=e,{user:r,isLoading:i}=(0,u.A)(),c=(0,a.useRouter)(),l=(0,o.q)();return((0,s.useEffect)(()=>{l&&!i&&(r||c.push("/login"))},[r,i,c,l]),!l||i)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):r?(0,n.jsx)(n.Fragment,{children:t}):null}},7600:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,O:()=>o});var n=r(5155),u=r(2115),a=r(5695);let s=(0,u.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,u.useState)(null),[i,c]=(0,u.useState)(!0),[l,h]=(0,u.useState)(!1),d=(0,a.useRouter)();(0,u.useEffect)(()=>{let e=setTimeout(()=>{f()},0);return()=>clearTimeout(e)},[]);let f=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();o(t.user)}}catch(e){console.error("Erreur lors de la v\xe9rification de l'authentification:",e)}finally{c(!1),h(!0)}},m=async(e,t)=>{try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(r.ok){let e=await r.json();return o(e.user),!0}return!1}catch(e){return console.error("Erreur lors de la connexion:",e),!1}},y=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),o(null),d.push("/login")}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}},p=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();o(t.user)}}catch(e){console.error("Erreur lors du rafra\xeechissement des donn\xe9es utilisateur:",e)}};return(0,n.jsx)(s.Provider,{value:{user:r,isLoading:i,login:m,logout:y,refreshUser:p},children:t})}function i(){let e=(0,u.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[441,964,358],()=>e(e.s=4324)),_N_E=e.O()}]);