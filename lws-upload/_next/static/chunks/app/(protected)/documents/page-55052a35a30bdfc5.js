(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[473],{2855:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ed});var t=a(5155),l=a(2115),r=a(5695),i=a(4379),n=a(285),c=a(6695),d=a(5365),o=a(5127),x=a(4838),h=a(7213),m=a(9803),u=a(227),p=a(7434),j=a(9890),g=a(4616),v=a(5213),f=a(5488),N=a(5623),y=a(2657),w=a(1788),A=a(3717),b=a(6516),C=a(2525),k=a(9869),S=a(93),P=a(5391),z=a(2094),M=a(2392),E=a(7944),D=a(8382),T=a(2523),V=a(5057),_=a(6126),O=a(2346),B=a(9409),L=a(6932),F=a(9946);let W=(0,F.A)("file-type",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]]),I=(0,F.A)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var R=a(6693),q=a(4395),J=a(3332),$=a(4416),H=a(133);let Q=[{value:"all",label:"Tous les types"},{value:"pdf",label:"PDF"},{value:"image",label:"Images"},{value:"video",label:"Vid\xe9os"},{value:"audio",label:"Audio"},{value:"text",label:"Texte"},{value:"sheet",label:"Tableurs"},{value:"doc",label:"Documents"},{value:"archive",label:"Archives"}],U=[{value:"updatedAt",label:"Date de modification"},{value:"createdAt",label:"Date de cr\xe9ation"},{value:"title",label:"Nom"},{value:"fileSize",label:"Taille"},{value:"fileName",label:"Nom du fichier"}];function Z(e){let{isOpen:s,onClose:a,filters:r,onApplyFilters:i,folders:c=[],availableTags:d=[]}=e,[o,x]=(0,l.useState)(r),[h,m]=(0,l.useState)(r.tags||[]),[u,p]=(0,l.useState)(""),j=()=>{u.trim()&&!h.includes(u.trim())&&(m([...h,u.trim()]),p(""))};return(0,t.jsx)(D.cj,{open:s,onOpenChange:a,children:(0,t.jsxs)(D.h,{className:"w-[400px] sm:w-[540px] overflow-y-auto",children:[(0,t.jsxs)(D.Fm,{children:[(0,t.jsxs)(D.qp,{className:"flex items-center gap-2",children:[(0,t.jsx)(L.A,{className:"h-5 w-5"}),"Filtres avanc\xe9s"]}),(0,t.jsx)(D.Qs,{children:"Affinez votre recherche avec des filtres d\xe9taill\xe9s"})]}),(0,t.jsxs)("div",{className:"space-y-6 py-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(V.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(W,{className:"h-4 w-4"}),"Type de fichier"]}),(0,t.jsxs)(B.l6,{value:o.fileType||"all",onValueChange:e=>x({...o,fileType:"all"===e?void 0:e}),children:[(0,t.jsx)(B.bq,{children:(0,t.jsx)(B.yv,{placeholder:"S\xe9lectionner un type"})}),(0,t.jsx)(B.gC,{children:Q.map(e=>(0,t.jsx)(B.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsx)(O.w,{}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(V.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(I,{className:"h-4 w-4"}),"Taille du fichier"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(V.J,{className:"text-xs text-muted-foreground",children:"Min (MB)"}),(0,t.jsx)(T.p,{type:"number",placeholder:"0",value:o.minSize?o.minSize/1048576:"",onChange:e=>x({...o,minSize:e.target.value?1024*parseFloat(e.target.value)*1024:void 0})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(V.J,{className:"text-xs text-muted-foreground",children:"Max (MB)"}),(0,t.jsx)(T.p,{type:"number",placeholder:"100",value:o.maxSize?o.maxSize/1048576:"",onChange:e=>x({...o,maxSize:e.target.value?1024*parseFloat(e.target.value)*1024:void 0})})]})]})]}),(0,t.jsx)(O.w,{}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(V.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(R.A,{className:"h-4 w-4"}),"P\xe9riode"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(V.J,{className:"text-xs text-muted-foreground",children:"Date d\xe9but"}),(0,t.jsx)(T.p,{type:"date",value:o.startDate||"",onChange:e=>x({...o,startDate:e.target.value||void 0})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(V.J,{className:"text-xs text-muted-foreground",children:"Date fin"}),(0,t.jsx)(T.p,{type:"date",value:o.endDate||"",onChange:e=>x({...o,endDate:e.target.value||void 0})})]})]})]}),(0,t.jsx)(O.w,{}),c.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(V.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(q.A,{className:"h-4 w-4"}),"Dossier"]}),(0,t.jsxs)(B.l6,{value:o.folderId||"all",onValueChange:e=>x({...o,folderId:"all"===e?void 0:e}),children:[(0,t.jsx)(B.bq,{children:(0,t.jsx)(B.yv,{placeholder:"Tous les dossiers"})}),(0,t.jsxs)(B.gC,{children:[(0,t.jsx)(B.eb,{value:"all",children:"Tous les dossiers"}),(0,t.jsx)(B.eb,{value:"root",children:"Racine (sans dossier)"}),c.map(e=>(0,t.jsx)(B.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsx)(O.w,{})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(V.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(J.A,{className:"h-4 w-4"}),"Tags"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(T.p,{placeholder:"Ajouter un tag...",value:u,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),j())}}),(0,t.jsx)(n.$,{onClick:j,size:"sm",children:"Ajouter"})]}),h.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:h.map(e=>(0,t.jsxs)(_.E,{variant:"secondary",className:"gap-1",children:[e,(0,t.jsx)($.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>{m(h.filter(s=>s!==e))}})]},e))})]}),(0,t.jsx)(O.w,{}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(V.J,{children:"Trier par"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(B.l6,{value:o.sortBy||"updatedAt",onValueChange:e=>x({...o,sortBy:e}),children:[(0,t.jsx)(B.bq,{children:(0,t.jsx)(B.yv,{})}),(0,t.jsx)(B.gC,{children:U.map(e=>(0,t.jsx)(B.eb,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)(B.l6,{value:o.sortOrder||"desc",onValueChange:e=>x({...o,sortOrder:e}),children:[(0,t.jsx)(B.bq,{children:(0,t.jsx)(B.yv,{})}),(0,t.jsxs)(B.gC,{children:[(0,t.jsx)(B.eb,{value:"desc",children:"D\xe9croissant"}),(0,t.jsx)(B.eb,{value:"asc",children:"Croissant"})]})]})]})]})]}),(0,t.jsxs)(D.XW,{className:"flex gap-2",children:[(0,t.jsxs)(n.$,{variant:"outline",onClick:()=>{let e={sortBy:"updatedAt",sortOrder:"desc"};x(e),m([]),i(e)},className:"flex-1",children:[(0,t.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"R\xe9initialiser"]}),(0,t.jsxs)(n.$,{onClick:()=>{i({...o,tags:h.length>0?h:void 0}),a()},className:"flex-1",children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Appliquer les filtres"]})]})]})})}var G=a(9434),K=a(1007);function X(e){var s,a,r,i,d,o;let{document:g,onView:v,onEdit:f,onDownload:k,onShare:S,onDelete:P}=e,[z,M]=(0,l.useState)(!1),E=(d=null==(s=g.currentVersion)?void 0:s.fileType)?d.startsWith("image/")?h.A:d.startsWith("video/")?m.A:d.startsWith("audio/")?u.A:"application/pdf"===d||d.startsWith("text/")?p.A:j.A:j.A;return(0,t.jsx)(c.Zp,{className:"group relative cursor-pointer transition-all duration-200 hover:shadow-lg ".concat(z?"ring-2 ring-blue-500 ring-opacity-50":""),onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),onClick:()=>v(g),children:(0,t.jsxs)(c.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat((o=null==(a=g.currentVersion)?void 0:a.fileType)?o.startsWith("image/")?"bg-blue-100 text-blue-600":o.startsWith("video/")?"bg-purple-100 text-purple-600":o.startsWith("audio/")?"bg-green-100 text-green-600":"application/pdf"===o?"bg-red-100 text-red-600":o.startsWith("text/")?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600":"bg-gray-100 text-gray-600"),children:(0,t.jsx)(E,{className:"w-6 h-6"})}),(0,t.jsxs)(x.rI,{children:[(0,t.jsx)(x.ty,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,t.jsx)(n.$,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(N.A,{className:"w-4 h-4"})})}),(0,t.jsxs)(x.SQ,{align:"end",children:[(0,t.jsxs)(x._2,{onClick:e=>{e.stopPropagation(),v(g)},children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Voir"]}),(0,t.jsxs)(x._2,{onClick:e=>{e.stopPropagation(),k(g)},children:[(0,t.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"T\xe9l\xe9charger"]}),(0,t.jsxs)(x._2,{onClick:e=>{e.stopPropagation(),f(g)},children:[(0,t.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"Modifier"]}),(0,t.jsxs)(x._2,{onClick:e=>{e.stopPropagation(),S(g)},children:[(0,t.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Partager"]}),(0,t.jsx)(x.mB,{}),(0,t.jsxs)(x._2,{onClick:e=>{e.stopPropagation(),P(g.id)},className:"text-red-600",children:[(0,t.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,t.jsx)("h3",{className:"font-medium text-sm line-clamp-2 leading-tight",title:g.title,children:g.title}),g.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",title:g.description,children:g.description})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[g.currentVersion&&(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:(0,G.v7)(g.currentVersion.fileSize)}),(0,t.jsxs)("span",{children:["v",g.currentVersion.versionNumber]})]}),g.folder&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,t.jsx)(q.A,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:g.folder.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,t.jsx)(K.A,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:g.author.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,t.jsx)(R.A,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:(0,G.fw)(g.updatedAt)})]}),g.tags.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[g.tags.slice(0,2).map(e=>(0,t.jsx)(_.E,{variant:"secondary",className:"text-xs px-1 py-0",children:e.name},e.id)),g.tags.length>2&&(0,t.jsxs)(_.E,{variant:"outline",className:"text-xs px-1 py-0",children:["+",g.tags.length-2]})]}),g._count&&(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-2 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(null!=(r=g._count.versions)?r:0)>1&&(0,t.jsxs)("span",{children:[g._count.versions," versions"]}),(null!=(i=g._count.shares)?i:0)>0&&(0,t.jsxs)("span",{children:[g._count.shares," partages"]})]}),g.isPublic&&(0,t.jsx)(_.E,{variant:"outline",className:"text-xs",children:"Public"})]})]})]})})}var Y=a(5327);let ee=(0,F.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var es=a(3052);let ea=e=>{let{className:s,...a}=e;return(0,t.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,G.cn)("mx-auto flex w-full justify-center",s),...a})};ea.displayName="Pagination";let et=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("ul",{ref:s,className:(0,G.cn)("flex flex-row items-center gap-1",a),...l})});et.displayName="PaginationContent";let el=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("li",{ref:s,className:(0,G.cn)("",a),...l})});el.displayName="PaginationItem";let er=e=>{let{className:s,isActive:a,size:l="icon",...r}=e;return(0,t.jsx)("a",{"aria-current":a?"page":void 0,className:(0,G.cn)((0,n.r)({variant:a?"outline":"ghost",size:l}),s),...r})};er.displayName="PaginationLink";let ei=e=>{let{className:s,...a}=e;return(0,t.jsxs)(er,{"aria-label":"Go to previous page",size:"default",className:(0,G.cn)("gap-1 pl-2.5",s),...a,children:[(0,t.jsx)(ee,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Pr\xe9c\xe9dent"})]})};ei.displayName="PaginationPrevious";let en=e=>{let{className:s,...a}=e;return(0,t.jsxs)(er,{"aria-label":"Go to next page",size:"default",className:(0,G.cn)("gap-1 pr-2.5",s),...a,children:[(0,t.jsx)("span",{children:"Suivant"}),(0,t.jsx)(es.A,{className:"h-4 w-4"})]})};en.displayName="PaginationNext";let ec=e=>{let{className:s,...a}=e;return(0,t.jsxs)("span",{"aria-hidden":!0,className:(0,G.cn)("flex h-9 w-9 items-center justify-center",s),...a,children:[(0,t.jsx)(N.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More pages"})]})};function ed(){let e=(0,r.useRouter)(),s=(0,r.useSearchParams)(),{folders:a}=(0,Y.n)(),[D,T]=(0,l.useState)([]),[V,_]=(0,l.useState)([]),[O,B]=(0,l.useState)(!0),[L,F]=(0,l.useState)(""),[W,I]=(0,l.useState)(""),[R,q]=(0,l.useState)("list"),[J,$]=(0,l.useState)("createdAt"),[H,Q]=(0,l.useState)("desc"),[U,G]=(0,l.useState)(null),[K,ee]=(0,l.useState)(!1),[es,ed]=(0,l.useState)(!1),[eo,ex]=(0,l.useState)(!1),[eh,em]=(0,l.useState)(!1),[eu,ep]=(0,l.useState)({sortBy:"updatedAt",sortOrder:"desc"}),[ej,eg]=(0,l.useState)({page:1,limit:20,total:0,totalPages:0});(0,l.useEffect)(()=>{let e=s.get("search");e&&(I(e),ep(s=>({...s,search:e})))},[s]),(0,l.useEffect)(()=>{ev()},[eu,ej.page]),(0,l.useEffect)(()=>{ef()},[D,W,J,H]);let ev=async()=>{try{B(!0);let e=new URLSearchParams;eu.search&&e.append("search",eu.search),eu.fileType&&e.append("fileType",eu.fileType),eu.minSize&&e.append("minSize",eu.minSize.toString()),eu.maxSize&&e.append("maxSize",eu.maxSize.toString()),eu.startDate&&e.append("startDate",eu.startDate),eu.endDate&&e.append("endDate",eu.endDate),eu.folderId&&e.append("folderId",eu.folderId),eu.tags&&eu.tags.length>0&&e.append("tags",eu.tags.join(",")),eu.sortBy&&e.append("sortBy",eu.sortBy),eu.sortOrder&&e.append("sortOrder",eu.sortOrder),e.append("page",ej.page.toString()),e.append("limit",ej.limit.toString());let s=await fetch("/api/documents?".concat(e.toString()));if(s.ok){let e=await s.json();T(e.documents),eg(e.pagination)}else F("Erreur lors du chargement des fichiers")}catch(e){F("Erreur de connexion")}finally{B(!1)}},ef=()=>{let e=D;W&&(e=e.filter(e=>{var s,a,t;return e.title.toLowerCase().includes(W.toLowerCase())||((null==(a=e.currentVersion)||null==(s=a.fileName)?void 0:s.toLowerCase())||"").includes(W.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(W.toLowerCase()))}));let s=(e,s)=>{var a,t,l;switch(s){case"title":return(null==(a=e.title)?void 0:a.toLowerCase())||"";case"createdAt":return new Date(e.createdAt).getTime();case"updatedAt":return new Date(e.updatedAt).getTime();case"fileSize":return(null==(t=e.currentVersion)?void 0:t.fileSize)||0;case"fileType":return(null==(l=e.currentVersion)?void 0:l.fileType)||""}};e.sort((e,a)=>{let t=s(e,J),l=s(a,J);return"asc"===H?t>l?1:-1:t<l?1:-1}),_(e)},eN=e=>{J===e?Q("asc"===H?"desc":"asc"):($(e),Q("asc"))},ey=async e=>{try{let a=await fetch("/api/documents/".concat(e.id,"/download"));if(a.ok){var s;let t=await a.blob(),l=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=l,r.download=(null==(s=e.currentVersion)?void 0:s.fileName)||"document",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(l)}}catch(e){console.error("Erreur t\xe9l\xe9chargement:",e)}},ew=async e=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer ce document ?"))try{(await fetch("/api/documents/".concat(e),{method:"DELETE"})).ok?T(s=>s.filter(s=>s.id!==e)):F("Erreur lors de la suppression")}catch(e){F("Erreur de connexion")}},eA=e=>{G(e),ee(!0)},eb=e=>{G(e),ed(!0)};return O?(0,t.jsx)(i.O,{children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),(0,t.jsx)("p",{className:"mt-2",children:"Chargement des fichiers..."})]})}):(0,t.jsxs)(i.O,{children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"w-8 h-8"}),"Mes Documents"]}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[D.length," fichier(s) au total"]})]}),(0,t.jsxs)(n.$,{onClick:()=>e.push("/upload"),children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Ajouter des fichiers"]})]}),(0,t.jsx)(E.s,{searchQuery:W,onSearchQueryChange:e=>{I(e),ep(s=>({...s,search:e||void 0}))},viewMode:R,onViewModeChange:q,sortField:J,sortOrder:H,onSortFieldChange:$,onSortOrderChange:Q,onOpenFilters:()=>em(!0)}),L&&(0,t.jsx)(d.Fc,{variant:"destructive",children:(0,t.jsx)(d.TN,{children:L})}),"list"===R?(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Documents"}),(0,t.jsxs)(c.BT,{children:[V.length," document(s) affich\xe9(s)"]})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsxs)(o.XI,{children:[(0,t.jsx)(o.A0,{children:(0,t.jsxs)(o.Hj,{children:[(0,t.jsx)(o.nd,{className:"w-8 sm:w-12"}),(0,t.jsx)(o.nd,{className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:()=>eN("title"),children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["Nom","title"===J&&("asc"===H?(0,t.jsx)(v.A,{className:"w-4 h-4"}):(0,t.jsx)(f.A,{className:"w-4 h-4"}))]})}),(0,t.jsx)(o.nd,{className:"hidden md:table-cell cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:()=>eN("fileSize"),children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["Taille","fileSize"===J&&("asc"===H?(0,t.jsx)(v.A,{className:"w-4 h-4"}):(0,t.jsx)(f.A,{className:"w-4 h-4"}))]})}),(0,t.jsx)(o.nd,{className:"hidden sm:table-cell cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:()=>eN("createdAt"),children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["Date d'ajout","createdAt"===J&&("asc"===H?(0,t.jsx)(v.A,{className:"w-4 h-4"}):(0,t.jsx)(f.A,{className:"w-4 h-4"}))]})}),(0,t.jsx)(o.nd,{className:"hidden lg:table-cell",children:"Propri\xe9taire"}),(0,t.jsx)(o.nd,{className:"w-10 sm:w-12"})]})}),(0,t.jsx)(o.BF,{children:V.map(e=>{var s,a,l,r,i,c,d;return(0,t.jsxs)(o.Hj,{children:[(0,t.jsx)(o.nA,{children:(d=(null==(s=e.currentVersion)?void 0:s.fileType)||"unknown").startsWith("image/")?(0,t.jsx)(h.A,{className:"w-4 h-4 text-blue-500"}):d.startsWith("video/")?(0,t.jsx)(m.A,{className:"w-4 h-4 text-purple-500"}):d.startsWith("audio/")?(0,t.jsx)(u.A,{className:"w-4 h-4 text-green-500"}):d.includes("pdf")?(0,t.jsx)(p.A,{className:"w-4 h-4 text-red-500"}):(0,t.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})}),(0,t.jsx)(o.nA,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:(null==(a=e.currentVersion)?void 0:a.fileName)||"Sans fichier"}),e.description&&(0,t.jsx)("div",{className:"hidden sm:block text-xs text-gray-400 mt-1",children:e.description})]})}),(0,t.jsx)(o.nA,{className:"hidden md:table-cell",children:(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]})((null==(l=e.currentVersion)?void 0:l.fileSize)||0)}),(0,t.jsx)(o.nA,{className:"hidden sm:table-cell",children:new Date(e.createdAt).toLocaleDateString("fr-FR")}),(0,t.jsx)(o.nA,{className:"hidden lg:table-cell",children:(null==(r=e.author)?void 0:r.name)||"Inconnu"}),(0,t.jsx)(o.nA,{children:(0,t.jsxs)(x.rI,{children:[(0,t.jsx)(x.ty,{asChild:!0,children:(0,t.jsx)(n.$,{variant:"ghost",size:"sm",children:(0,t.jsx)(N.A,{className:"w-4 h-4"})})}),(0,t.jsxs)(x.SQ,{align:"end",children:[(0,t.jsxs)(x._2,{onClick:()=>eA(e),children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Aper\xe7u"]}),(0,t.jsxs)(x._2,{onClick:()=>ey(e),children:[(0,t.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"T\xe9l\xe9charger"]}),(0,t.jsx)(x._2,{asChild:!0,children:(0,t.jsx)(z.W,{documentId:e.id,documentTitle:e.title,trigger:(0,t.jsxs)("div",{className:"flex items-center w-full px-2 py-1.5 cursor-pointer",children:[(0,t.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Versions (",null!=(c=null==(i=e._count)?void 0:i.versions)?c:0,")"]})})}),(0,t.jsxs)(x._2,{onClick:()=>eb(e),children:[(0,t.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"Modifier"]}),(0,t.jsxs)(x._2,{onClick:()=>{G(e),ex(!0)},children:[(0,t.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Partager"]}),(0,t.jsx)(x.mB,{}),(0,t.jsxs)(x._2,{onClick:()=>ew(e.id),className:"text-red-600",children:[(0,t.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},e.id)})})]}),0===V.length&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(k.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:W?"Aucun document trouv\xe9":"Aucun document"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:W?"Essayez de modifier votre recherche":"Commencez par uploader vos premiers fichiers"}),!W&&(0,t.jsxs)(n.$,{onClick:()=>e.push("/upload"),children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Ajouter des fichiers"]})]})]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:V.length>0?V.map(e=>(0,t.jsx)(X,{document:e,onView:eA,onEdit:eb,onDownload:ey,onShare:e=>{G(e),ex(!0)},onDelete:ew},e.id)):(0,t.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,t.jsx)(p.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"Aucun document trouv\xe9"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:W||Object.values(eu).some(e=>e&&"updatedAt"!==e&&"desc"!==e)?"Aucun document ne correspond \xe0 vos crit\xe8res de recherche.":"Commencez par ajouter des documents \xe0 votre collection."}),(0,t.jsxs)(n.$,{className:"mt-4",onClick:()=>e.push("/upload"),children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Ajouter des fichiers"]})]})})]}),K&&U&&(0,t.jsx)(S.P,{document:U,isOpen:K,onClose:()=>ee(!1)}),es&&U&&(0,t.jsx)(P.d,{document:U,isOpen:es,onClose:()=>ed(!1),onSave:e=>{T(s=>s.map(s=>s.id===e.id?e:s)),ed(!1)}}),eo&&U&&(0,t.jsx)(M.a,{document:U,isOpen:eo,onClose:()=>ex(!1),onShared:()=>{ev()}}),ej.totalPages>1&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(ea,{children:(0,t.jsxs)(et,{children:[(0,t.jsx)(el,{children:(0,t.jsx)(ei,{onClick:()=>eg(e=>({...e,page:Math.max(1,e.page-1)})),className:1===ej.page?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(Math.min(5,ej.totalPages))].map((e,s)=>{let a=s+1;return(0,t.jsx)(el,{children:(0,t.jsx)(er,{onClick:()=>eg(e=>({...e,page:a})),isActive:ej.page===a,className:"cursor-pointer",children:a})},a)}),ej.totalPages>5&&(0,t.jsx)(el,{children:(0,t.jsx)(ec,{})}),(0,t.jsx)(el,{children:(0,t.jsx)(en,{onClick:()=>eg(e=>({...e,page:Math.min(ej.totalPages,e.page+1)})),className:ej.page===ej.totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})}),(0,t.jsxs)("div",{className:"text-center text-sm text-muted-foreground mt-2",children:["Page ",ej.page," sur ",ej.totalPages," â€¢ ",ej.total," documents au total"]})]}),(0,t.jsx)(Z,{isOpen:eh,onClose:()=>em(!1),filters:eu,onApplyFilters:e=>{ep(e),e.search!==W&&I(e.search||""),eg(e=>({...e,page:1}))},folders:a})]})}ec.displayName="PaginationEllipsis"},3332:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},4205:(e,s,a)=>{Promise.resolve().then(a.bind(a,2855))},5327:(e,s,a)=>{"use strict";a.d(s,{n:()=>l});var t=a(2115);function l(){let[e,s]=(0,t.useState)([]),[a,l]=(0,t.useState)(!0),[r,i]=(0,t.useState)(null),n=async()=>{try{l(!0),i(null);let e=await fetch("/api/sidebar/folders",{credentials:"include"});if(e.ok){let a=await e.json();s(a.folders||[])}else if(401===e.status)s([]);else throw Error("Erreur ".concat(e.status))}catch(e){console.error("Erreur lors du chargement des dossiers:",e),i(e instanceof Error?e.message:"Erreur inconnue"),s([])}finally{l(!1)}};return(0,t.useEffect)(()=>{n()},[]),{folders:e,isLoading:a,error:r,refresh:()=>{n()}}}},6693:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9890:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])}},e=>{e.O(0,[785,882,412,804,209,653,441,964,358],()=>e(e.s=4205)),_N_E=e.O()}]);