(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{796:(e,t,r)=>{Promise.resolve().then(r.bind(r,3792))},1926:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var u=r(2115);function a(){let[e,t]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{t(!0)},[]),e}},3792:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var u=r(5155),a=r(7600),s=r(5695),n=r(2115),o=r(1926);function i(){let{user:e,isLoading:t}=(0,a.A)(),r=(0,s.useRouter)(),i=(0,o.q)();return((0,n.useEffect)(()=>{i&&!t&&(e?r.push("/dashboard"):r.push("/login"))},[e,t,r,i]),!i||t)?(0,u.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,u.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):null}},5695:(e,t,r)=>{"use strict";var u=r(8999);r.o(u,"usePathname")&&r.d(t,{usePathname:function(){return u.usePathname}}),r.o(u,"useRouter")&&r.d(t,{useRouter:function(){return u.useRouter}}),r.o(u,"useSearchParams")&&r.d(t,{useSearchParams:function(){return u.useSearchParams}})},7600:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,O:()=>o});var u=r(5155),a=r(2115),s=r(5695);let n=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0),[l,h]=(0,a.useState)(!1),d=(0,s.useRouter)();(0,a.useEffect)(()=>{let e=setTimeout(()=>{f()},0);return()=>clearTimeout(e)},[]);let f=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();o(t.user)}}catch(e){console.error("Erreur lors de la v\xe9rification de l'authentification:",e)}finally{c(!1),h(!0)}},m=async(e,t)=>{try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(r.ok){let e=await r.json();return o(e.user),!0}return!1}catch(e){return console.error("Erreur lors de la connexion:",e),!1}},p=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),o(null),d.push("/login")}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}},y=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();o(t.user)}}catch(e){console.error("Erreur lors du rafra\xeechissement des donn\xe9es utilisateur:",e)}};return(0,u.jsx)(n.Provider,{value:{user:r,isLoading:i,login:m,logout:p,refreshUser:y},children:t})}function i(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[441,964,358],()=>e(e.s=796)),_N_E=e.O()}]);