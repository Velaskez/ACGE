(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[118],{772:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var r=a(5155),l=a(2115),t=a(4379),c=a(6695),i=a(285),n=a(2523),d=a(5057),m=a(6126),o=a(5365),x=a(2346),h=a(7600),u=a(9434),j=a(1007),p=a(5339),N=a(9946);let f=(0,N.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var v=a(5525),g=a(7434),w=a(6516),y=a(6693);let b=(0,N.A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var E=a(8749),P=a(2657),A=a(1154),k=a(4229),M=a(8856);function C(){let{user:e,refreshUser:s}=(0,h.A)(),[a,N]=(0,l.useState)(null),[C,S]=(0,l.useState)(!0),[F,z]=(0,l.useState)(!1),[_,L]=(0,l.useState)(""),[R,D]=(0,l.useState)(""),[J,T]=(0,l.useState)({name:"",email:"",currentPassword:"",newPassword:"",confirmPassword:""}),[q,O]=(0,l.useState)(!1),[V,W]=(0,l.useState)(!1),[Z,$]=(0,l.useState)(!1);(0,l.useEffect)(()=>{G()},[]),(0,l.useEffect)(()=>{e&&!a&&""===J.name&&""===J.email&&T({name:e.name||"",email:e.email||"",currentPassword:"",newPassword:"",confirmPassword:""})},[e,a,J.name,J.email]);let I=a||(e?{id:e.id,name:e.name,email:e.email,role:e.role,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),_count:{documents:0,sharedWith:0}}:null),G=async()=>{try{S(!0),L("");let e=await fetch("/api/profile");if(e.ok){let s=await e.json();N(s.user),T({name:s.user.name||"",email:s.user.email||"",currentPassword:"",newPassword:"",confirmPassword:""})}else{let s=await e.json().catch(()=>({}));L("Erreur lors du chargement du profil: ".concat(s.error||e.status))}}catch(e){L("Erreur de connexion: ".concat(e instanceof Error?e.message:"Erreur inconnue"))}finally{S(!1)}},U=(e,s)=>{T(a=>({...a,[e]:s})),_&&L(""),R&&D("")},B=async e=>{if(e.preventDefault(),(()=>{if(!J.name.trim())return L("Le nom est requis"),!1;if(!J.email.trim())return L("L'email est requis"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(J.email))return L("Format d'email invalide"),!1;if(J.newPassword){if(!J.currentPassword)return L("Le mot de passe actuel est requis pour changer le mot de passe"),!1;if(J.newPassword.length<6)return L("Le nouveau mot de passe doit contenir au moins 6 caract\xe8res"),!1;if(J.newPassword!==J.confirmPassword)return L("La confirmation du mot de passe ne correspond pas"),!1}return!0})())try{z(!0),L(""),D("");let e={name:J.name.trim(),email:J.email.trim()};J.newPassword&&(e.currentPassword=J.currentPassword,e.newPassword=J.newPassword);let a=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await a.json();a.ok?(D("Profil mis \xe0 jour avec succ\xe8s !"),T(e=>({...e,currentPassword:"",newPassword:"",confirmPassword:""})),await Promise.all([G(),s()]),setTimeout(()=>D(""),5e3)):L(r.error||"Erreur lors de la mise \xe0 jour")}catch(e){L("Erreur de connexion")}finally{z(!1)}};return(0,r.jsx)(t.O,{title:"Mon Profil",description:"G\xe9rez vos informations personnelles et votre s\xe9curit\xe9",icon:j.A,children:C?(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(c.Zp,{children:[(0,r.jsx)(c.aR,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(M.E,{className:"h-5 w-5"}),(0,r.jsx)(M.E,{className:"h-6 w-40"})]})}),(0,r.jsxs)(c.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(M.E,{className:"w-12 h-12 rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-5 w-32"}),(0,r.jsx)(M.E,{className:"h-4 w-48"})]})]}),(0,r.jsx)(M.E,{className:"h-px w-full"}),(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:4}).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(M.E,{className:"h-4 w-20"}),(0,r.jsx)(M.E,{className:"h-4 w-16"})]},s))})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(M.E,{className:"h-5 w-5"}),(0,r.jsx)(M.E,{className:"h-6 w-32"})]}),(0,r.jsx)(M.E,{className:"h-4 w-64"})]}),(0,r.jsxs)(c.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(M.E,{className:"h-6 w-40"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-4 w-24"}),(0,r.jsx)(M.E,{className:"h-9 w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-4 w-20"}),(0,r.jsx)(M.E,{className:"h-9 w-full"})]})]})]}),(0,r.jsx)(M.E,{className:"h-px w-full"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(M.E,{className:"h-5 w-5"}),(0,r.jsx)(M.E,{className:"h-6 w-40"})]}),(0,r.jsx)(M.E,{className:"h-4 w-80"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-4 w-32"}),(0,r.jsx)(M.E,{className:"h-9 w-full"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-4 w-28"}),(0,r.jsx)(M.E,{className:"h-9 w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(M.E,{className:"h-4 w-36"}),(0,r.jsx)(M.E,{className:"h-9 w-full"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(M.E,{className:"h-9 w-20"}),(0,r.jsx)(M.E,{className:"h-9 w-44"})]})]})]})})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[_&&(0,r.jsxs)(o.Fc,{variant:"destructive",children:[(0,r.jsx)(p.A,{className:"h-4 w-4"}),(0,r.jsx)(o.TN,{children:_})]}),R&&(0,r.jsxs)(o.Fc,{className:"border-green-200 bg-green-50",children:[(0,r.jsx)(f,{className:"h-4 w-4 text-green-600"}),(0,r.jsx)(o.TN,{className:"text-green-800",children:R})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(c.Zp,{children:[(0,r.jsx)(c.aR,{children:(0,r.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(v.A,{className:"h-5 w-5"}),"Informations du compte"]})}),(0,r.jsx)(c.Wu,{className:"space-y-4",children:I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(j.A,{className:"h-6 w-6 text-gray-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:I.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:I.email})]})]}),(0,r.jsx)(x.w,{}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"R\xf4le"}),(e=>{let s={ADMIN:{label:"Administrateur",className:"bg-red-100 text-red-800"},MANAGER:{label:"Gestionnaire",className:"bg-blue-100 text-blue-800"},USER:{label:"Utilisateur",className:"bg-green-100 text-green-800"}},a=s[e]||s.USER;return(0,r.jsx)(m.E,{className:a.className,children:a.label})})(I.role)]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Documents"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm",children:I._count.documents})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Partages re\xe7us"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm",children:I._count.sharedWith})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Membre depuis"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm",children:(0,u.fw)(I.createdAt)})]})]})]})]})})]})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(j.A,{className:"h-5 w-5"}),"Modifier le profil"]}),(0,r.jsx)(c.BT,{children:"Mettez \xe0 jour vos informations personnelles et votre mot de passe"})]}),(0,r.jsx)(c.Wu,{children:(0,r.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Informations personnelles"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.J,{htmlFor:"name",children:"Nom complet"}),(0,r.jsx)(n.p,{id:"name",type:"text",value:J.name,onChange:e=>U("name",e.target.value),placeholder:"Votre nom complet",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.J,{htmlFor:"email",children:"Adresse email"}),(0,r.jsx)(n.p,{id:"email",type:"email",value:J.email,onChange:e=>U("email",e.target.value),placeholder:"votre@email.com",required:!0})]})]})]}),(0,r.jsx)(x.w,{}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b,{className:"h-5 w-5"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Changer le mot de passe"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Laissez vide si vous ne souhaitez pas changer votre mot de passe"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.J,{htmlFor:"currentPassword",children:"Mot de passe actuel"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.p,{id:"currentPassword",type:q?"text":"password",value:J.currentPassword,onChange:e=>U("currentPassword",e.target.value),placeholder:"Votre mot de passe actuel"}),(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>O(!q),children:q?(0,r.jsx)(E.A,{className:"h-4 w-4"}):(0,r.jsx)(P.A,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.J,{htmlFor:"newPassword",children:"Nouveau mot de passe"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.p,{id:"newPassword",type:V?"text":"password",value:J.newPassword,onChange:e=>U("newPassword",e.target.value),placeholder:"Nouveau mot de passe (min. 6 caract\xe8res)"}),(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>W(!V),children:V?(0,r.jsx)(E.A,{className:"h-4 w-4"}):(0,r.jsx)(P.A,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.J,{htmlFor:"confirmPassword",children:"Confirmer le nouveau mot de passe"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.p,{id:"confirmPassword",type:Z?"text":"password",value:J.confirmPassword,onChange:e=>U("confirmPassword",e.target.value),placeholder:"Confirmer le nouveau mot de passe"}),(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>$(!Z),children:Z?(0,r.jsx)(E.A,{className:"h-4 w-4"}):(0,r.jsx)(P.A,{className:"h-4 w-4"})})]})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(i.$,{type:"button",variant:"outline",onClick:G,disabled:F,children:"Annuler"}),(0,r.jsx)(i.$,{type:"submit",disabled:F,children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Enregistrer les modifications"]})})]})]})})]})})]})]})})}},968:(e,s,a)=>{"use strict";a.d(s,{b:()=>i});var r=a(2115),l=a(3655),t=a(5155),c=r.forwardRef((e,s)=>(0,t.jsx)(l.sG.label,{...e,ref:s,onMouseDown:s=>{var a;s.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));c.displayName="Label";var i=c},2657:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(9946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},4229:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(9946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5057:(e,s,a)=>{"use strict";a.d(s,{J:()=>c});var r=a(5155);a(2115);var l=a(968),t=a(9434);function c(e){let{className:s,...a}=e;return(0,r.jsx)(l.b,{"data-slot":"label",className:(0,t.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}},5365:(e,s,a)=>{"use strict";a.d(s,{Fc:()=>i,TN:()=>n});var r=a(5155);a(2115);var l=a(2085),t=a(9434);let c=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:a,...l}=e;return(0,r.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,t.cn)(c({variant:a}),s),...l})}function n(e){let{className:s,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-description",className:(0,t.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...a})}},5525:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(9946).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},6693:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},8749:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(9946).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},9074:(e,s,a)=>{Promise.resolve().then(a.bind(a,772))}},e=>{e.O(0,[785,882,209,441,964,358],()=>e(e.s=9074)),_N_E=e.O()}]);