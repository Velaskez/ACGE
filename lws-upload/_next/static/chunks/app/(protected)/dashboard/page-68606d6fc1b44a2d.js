(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{1667:(e,s,r)=>{Promise.resolve().then(r.bind(r,1888))},1788:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(9946).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},1888:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>b});var a=r(5155),c=r(6695),t=r(285),l=r(4379),n=r(6102),i=r(8856),d=r(5695),o=r(2115),x=r(9434),h=r(9946);let m=(0,h.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var u=r(9869),j=r(5339),p=r(7434),N=r(4395);let f=(0,h.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);var v=r(7580),g=r(2657),w=r(1788),y=r(4186);function b(){var e,s;let r=(0,d.useRouter)(),{stats:h,activity:b,isLoading:E,error:k,refreshData:A}=function(){let[e,s]=(0,o.useState)(null),[r,a]=(0,o.useState)(null),[c,t]=(0,o.useState)(!0),[l,n]=(0,o.useState)(null);return(0,o.useEffect)(()=>{(async()=>{try{let e,r;t(!0);let[c,l]=await Promise.all([fetch("/api/dashboard/stats",{credentials:"include"}),fetch("/api/dashboard/activity",{credentials:"include"})]);if(!c.ok||!l.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des donn\xe9es");try{e=await c.json()}catch(e){throw console.error("Erreur parsing stats response:",e),Error("Erreur lors du parsing des statistiques")}try{r=await l.json()}catch(e){throw console.error("Erreur parsing activity response:",e),Error("Erreur lors du parsing de l'activit\xe9")}s(e),a(r),n(null)}catch(e){console.error("Erreur dashboard:",e),n(e instanceof Error?e.message:"Erreur inconnue")}finally{t(!1)}})()},[]),{stats:e,activity:r,isLoading:c,error:l,refreshData:async()=>{t(!0);try{let e,r,[c,t]=await Promise.all([fetch("/api/dashboard/stats",{credentials:"include"}),fetch("/api/dashboard/activity",{credentials:"include"})]);if(!c.ok||!t.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des donn\xe9es");try{e=await c.json()}catch(e){throw console.error("Erreur parsing stats response:",e),Error("Erreur lors du parsing des statistiques")}try{r=await t.json()}catch(e){throw console.error("Erreur parsing activity response:",e),Error("Erreur lors du parsing de l'activit\xe9")}s(e),a(r),n(null)}catch(e){console.error("Erreur refresh dashboard:",e),n(e instanceof Error?e.message:"Erreur inconnue")}finally{t(!1)}}}}(),C=()=>{r.push("/upload")},Z=()=>{r.push("/documents")},B=async(e,s)=>{try{let r=await fetch("/api/documents/".concat(e,"/download"));if(r.ok){let e=await r.blob(),a=window.URL.createObjectURL(e),c=document.createElement("a");c.style.display="none",c.href=a,c.download=s||"document",document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(a)}else console.error("Erreur lors du t\xe9l\xe9chargement")}catch(e){console.error("Erreur t\xe9l\xe9chargement:",e)}};return(0,a.jsx)(l.O,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Tableau de bord"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Vue d'ensemble de vos fichiers et activit\xe9s"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[k&&(0,a.jsxs)(t.$,{variant:"outline",size:"sm",onClick:A,children:[(0,a.jsx)(m,{className:"mr-2 h-4 w-4"}),"Actualiser"]}),(0,a.jsxs)(t.$,{onClick:C,children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Nouveau document"]})]})]}),k&&(0,a.jsx)(c.Zp,{className:"border-red-200 bg-red-50",children:(0,a.jsx)(c.Wu,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsxs)("p",{className:"text-sm text-red-600",children:["Erreur lors du chargement des donn\xe9es: ",k]})]})})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(c.Zp,{className:"cursor-pointer hover:bg-accent/50 transition-colors",onClick:Z,children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"Total Fichiers"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(c.Wu,{children:E?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.E,{className:"h-8 w-16"}),(0,a.jsx)(i.E,{className:"h-4 w-32"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==h||null==(e=h.totalDocuments)?void 0:e.toLocaleString())||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==h?void 0:h.monthlyGrowthPercentage)?h.monthlyGrowthPercentage>0?"+".concat(h.monthlyGrowthPercentage,"% par rapport au mois dernier"):h.monthlyGrowthPercentage<0?"".concat(h.monthlyGrowthPercentage,"% par rapport au mois dernier"):"Aucune \xe9volution ce mois":"Pas de donn\xe9es historiques"})]})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"Dossiers"}),(0,a.jsx)(N.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(c.Wu,{children:E?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.E,{className:"h-8 w-16"}),(0,a.jsx)(i.E,{className:"h-4 w-32"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==h||null==(s=h.totalFolders)?void 0:s.toLocaleString())||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==h?void 0:h.documentsThisMonth)?"+".concat(h.documentsThisMonth," nouveaux ce mois"):"Aucun nouveau ce mois"})]})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"Espace utilis\xe9"}),(0,a.jsx)(f,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(c.Wu,{children:E?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.E,{className:"h-8 w-16"}),(0,a.jsx)(i.E,{className:"h-4 w-32"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==h?void 0:h.spaceUsed)?"".concat(h.spaceUsed.gb," GB"):"0 GB"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==h?void 0:h.spaceUsed)?"".concat(h.spaceUsed.percentage,"% de votre quota"):"0% de votre quota"})]})})]}),(0,a.jsxs)(c.Zp,{className:"cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>{r.push("/users")},children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"Utilisateurs actifs"}),(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(c.Wu,{children:E?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.E,{className:"h-8 w-16"}),(0,a.jsx)(i.E,{className:"h-4 w-32"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==h?void 0:h.activeUsers)||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==h?void 0:h.activeUsers)?"".concat(h.activeUsers," en ligne r\xe9cemment"):"Aucun utilisateur actif"})]})})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[(0,a.jsxs)(c.Zp,{className:"col-span-4",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.ZB,{children:"Fichiers r\xe9cents"}),(0,a.jsx)(c.BT,{children:"Vos derniers fichiers ajout\xe9s ou modifi\xe9s"})]}),(0,a.jsx)(t.$,{variant:"outline",size:"sm",onClick:Z,children:"Voir tous"})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:E?Array.from({length:4}).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(i.E,{className:"w-8 h-8 rounded"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(i.E,{className:"h-4 w-48"}),(0,a.jsx)(i.E,{className:"h-3 w-32"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(i.E,{className:"w-8 h-8"}),(0,a.jsx)(i.E,{className:"w-8 h-8"})]})]},s)):(null==h?void 0:h.recentDocuments)&&h.recentDocuments.length>0?h.recentDocuments.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-powder-blue/20 rounded flex items-center justify-center",children:(0,a.jsx)(p.A,{className:"w-4 h-4 text-powder-blue"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:e.title||e.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,x.fw)(e.updatedAt)," • ",(0,x.v7)(e.size)," • ",(0,x.Hx)(e.type)]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(n.Bc,{children:(0,a.jsxs)(n.m_,{children:[(0,a.jsx)(n.k$,{asChild:!0,children:(0,a.jsx)(t.$,{variant:"ghost",size:"icon",onClick:()=>{var s;return s=e.id,void r.push("/documents?view=".concat(s))},children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.ZI,{children:(0,a.jsx)("p",{children:"Voir le document"})})]})}),(0,a.jsx)(n.Bc,{children:(0,a.jsxs)(n.m_,{children:[(0,a.jsx)(n.k$,{asChild:!0,children:(0,a.jsx)(t.$,{variant:"ghost",size:"icon",onClick:()=>B(e.id,e.name),children:(0,a.jsx)(w.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.ZI,{children:(0,a.jsx)("p",{children:"T\xe9l\xe9charger"})})]})})]})]},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(p.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-muted-foreground",children:"Aucun document"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Commencez par t\xe9l\xe9charger votre premier document."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(t.$,{onClick:C,children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"T\xe9l\xe9charger un document"]})})]})})})]}),(0,a.jsxs)(c.Zp,{className:"col-span-3",children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Activit\xe9 r\xe9cente"}),(0,a.jsx)(c.BT,{children:"Derni\xe8res actions sur vos fichiers"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:E?Array.from({length:5}).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(i.E,{className:"w-2 h-2 rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(i.E,{className:"h-4 w-32"}),(0,a.jsx)(i.E,{className:"h-3 w-24"}),(0,a.jsx)(i.E,{className:"h-3 w-16"})]})]},s)):(null==b?void 0:b.activities)&&b.activities.length>0?b.activities.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-powder-blue rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.action}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.target}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,x.fw)(e.timestamp)})]})]},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(y.A,{className:"mx-auto h-8 w-8 text-muted-foreground"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-muted-foreground",children:"Aucune activit\xe9"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"Vos activit\xe9s r\xe9centes appara\xeetront ici."})]})})})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Actions rapides"}),(0,a.jsx)(c.BT,{children:"Acc\xe9dez rapidement aux fonctionnalit\xe9s principales"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(t.$,{variant:"outline",className:"h-20 flex-col",onClick:C,children:[(0,a.jsx)(u.A,{className:"h-6 w-6 mb-2"}),(0,a.jsx)("span",{children:"Upload"})]}),(0,a.jsxs)(t.$,{variant:"outline",className:"h-20 flex-col",onClick:()=>{console.log("Cr\xe9er un nouveau dossier")},children:[(0,a.jsx)(N.A,{className:"h-6 w-6 mb-2"}),(0,a.jsx)("span",{children:"Nouveau dossier"})]}),(0,a.jsxs)(t.$,{variant:"outline",className:"h-20 flex-col",onClick:()=>{console.log("Partager des documents")},children:[(0,a.jsx)(v.A,{className:"h-6 w-6 mb-2"}),(0,a.jsx)("span",{children:"Partager"})]}),(0,a.jsxs)(t.$,{variant:"outline",className:"h-20 flex-col",onClick:()=>{console.log("Afficher l'historique")},children:[(0,a.jsx)(y.A,{className:"h-6 w-6 mb-2"}),(0,a.jsx)("span",{children:"Historique"})]})]})})]})]})})}},2657:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(9946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},4186:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(9946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])}},e=>{e.O(0,[785,882,209,441,964,358],()=>e(e.s=1667)),_N_E=e.O()}]);