(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{1243:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1723:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var a=s(5155),l=s(2115),r=s(7600),n=s(5695),i=s(4379),d=s(285),o=s(6695),c=s(2523),u=s(5057),x=s(5365),m=s(9409),h=s(4165),p=s(5127),f=s(1243),j=s(7580),g=s(4616),v=s(1007);let b=(0,s(9946).A)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var N=s(5525),y=s(3717),w=s(2525);function A(){let{user:e}=(0,r.A)(),t=(0,n.useRouter)(),[s,A]=(0,l.useState)([]),[k,z]=(0,l.useState)(!0),[C,E]=(0,l.useState)(""),[M,_]=(0,l.useState)(!1),[S,R]=(0,l.useState)(null),[F,q]=(0,l.useState)({name:"",email:"",password:"",role:"USER"});(0,l.useEffect)(()=>{(null==e?void 0:e.role)!=="ADMIN"&&t.push("/dashboard")},[e,t]),(0,l.useEffect)(()=>{L()},[]);let L=async()=>{try{let e=await fetch("/api/users");if(e.ok){let t=await e.json();A(t.users)}else E("Erreur lors du chargement des utilisateurs")}catch(e){E("Erreur de connexion")}finally{z(!1)}},D=async e=>{e.preventDefault(),z(!0),E("");try{let e=S?"/api/users/".concat(S.id):"/api/users",t=S?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(s.ok)_(!1),R(null),U(),L();else{let e=await s.json();E(e.error||"Erreur lors de l'op\xe9ration")}}catch(e){E("Erreur de connexion")}finally{z(!1)}},T=async e=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer cet utilisateur ?"))try{(await fetch("/api/users/".concat(e),{method:"DELETE"})).ok?L():E("Erreur lors de la suppression")}catch(e){E("Erreur de connexion")}},U=()=>{q({name:"",email:"",password:"",role:"USER"})};return(null==e?void 0:e.role)!=="ADMIN"?(0,a.jsx)(i.O,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,a.jsxs)(o.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(f.A,{className:"w-5 h-5 text-orange-500"}),"Acc\xe8s refus\xe9"]}),(0,a.jsx)(o.BT,{children:"Vous n'avez pas les permissions n\xe9cessaires pour acc\xe9der \xe0 cette page."})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(d.$,{onClick:()=>t.push("/dashboard"),children:"Retour au dashboard"})})]})})}):(0,a.jsx)(i.O,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-8 h-8"}),"Gestion des Utilisateurs"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"G\xe9rez les utilisateurs et leurs permissions"})]}),(0,a.jsxs)(h.lG,{open:M,onOpenChange:_,children:[(0,a.jsx)(h.zM,{asChild:!0,children:(0,a.jsxs)(d.$,{onClick:()=>{R(null),U(),_(!0)},children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Nouvel utilisateur"]})}),(0,a.jsxs)(h.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:S?"Modifier l'utilisateur":"Nouvel utilisateur"}),(0,a.jsx)(h.rr,{children:S?"Modifiez les informations de l'utilisateur":"Cr\xe9ez un nouvel utilisateur avec ses permissions"})]}),(0,a.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[C&&(0,a.jsx)(x.Fc,{variant:"destructive",children:(0,a.jsx)(x.TN,{children:C})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"name",children:"Nom complet"}),(0,a.jsx)(c.p,{id:"name",value:F.name,onChange:e=>q(t=>({...t,name:e.target.value})),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(c.p,{id:"email",type:"email",value:F.email,onChange:e=>q(t=>({...t,email:e.target.value})),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"password",children:S?"Nouveau mot de passe (optionnel)":"Mot de passe"}),(0,a.jsx)(c.p,{id:"password",type:"password",value:F.password,onChange:e=>q(t=>({...t,password:e.target.value})),required:!S})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"role",children:"R\xf4le"}),(0,a.jsxs)(m.l6,{value:F.role,onValueChange:e=>q(t=>({...t,role:e})),children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"USER",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-4 h-4"}),"Utilisateur"]})}),(0,a.jsx)(m.eb,{value:"MANAGER",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b,{className:"w-4 h-4"}),"Manager"]})}),(0,a.jsx)(m.eb,{value:"ADMIN",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"Administrateur"]})})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.$,{type:"submit",disabled:k,className:"flex-1",children:k?"Enregistrement...":S?"Modifier":"Cr\xe9er"}),(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>_(!1),children:"Annuler"})]})]})]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Liste des utilisateurs"}),(0,a.jsxs)(o.BT,{children:[s.length," utilisateur(s) au total"]})]}),(0,a.jsx)(o.Wu,{children:k?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),(0,a.jsx)("p",{className:"mt-2",children:"Chargement..."})]}):(0,a.jsxs)(p.XI,{children:[(0,a.jsx)(p.A0,{children:(0,a.jsxs)(p.Hj,{children:[(0,a.jsx)(p.nd,{children:"Nom"}),(0,a.jsx)(p.nd,{children:"Email"}),(0,a.jsx)(p.nd,{children:"R\xf4le"}),(0,a.jsx)(p.nd,{children:"Date de cr\xe9ation"}),(0,a.jsx)(p.nd,{children:"Actions"})]})}),(0,a.jsx)(p.BF,{children:s.map(t=>(0,a.jsxs)(p.Hj,{children:[(0,a.jsx)(p.nA,{className:"font-medium",children:t.name}),(0,a.jsx)(p.nA,{children:t.email}),(0,a.jsx)(p.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["ADMIN"===t.role&&(0,a.jsx)(N.A,{className:"w-4 h-4 text-red-500"}),"MANAGER"===t.role&&(0,a.jsx)(b,{className:"w-4 h-4 text-blue-500"}),"USER"===t.role&&(0,a.jsx)(v.A,{className:"w-4 h-4 text-gray-500"}),t.role]})}),(0,a.jsx)(p.nA,{children:new Date(t.createdAt).toLocaleDateString("fr-FR")}),(0,a.jsx)(p.nA,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{R(t),q({name:t.name,email:t.email,password:"",role:t.role}),_(!0)},children:(0,a.jsx)(y.A,{className:"w-4 h-4"})}),t.id!==(null==e?void 0:e.id)&&(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>T(t.id),children:(0,a.jsx)(w.A,{className:"w-4 h-4"})})]})})]},t.id))})]})})]})]})})}},2525:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},3717:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},4165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>m,L3:()=>h,c7:()=>x,lG:()=>i,rr:()=>p,zM:()=>d});var a=s(5155);s(2115);var l=s(5452),r=s(4416),n=s(9434);function i(e){let{...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,a.jsx)(l.l9,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(l.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(l.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function u(e){let{className:t,children:s,showCloseButton:i=!0,...d}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(c,{}),(0,a.jsxs)(l.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-1rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border shadow-lg duration-200 max-h-[95vh] overflow-y-auto p-4 sm:p-6 sm:max-w-lg",t),...d,children:[s,i&&(0,a.jsxs)(l.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(r.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function m(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col gap-3 sm:flex-row sm:justify-end sm:gap-2 pt-4",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(l.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(l.VY,{"data-slot":"dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...s})}},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>n});var a=s(5155);s(2115);var l=s(968),r=s(9434);function n(e){let{className:t,...s}=e;return(0,a.jsx)(l.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}},5127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>n,BF:()=>i,Hj:()=>d,XI:()=>r,nA:()=>c,nd:()=>o});var a=s(5155);s(2115);var l=s(9434);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",t),...s})})}function n(e){let{className:t,...s}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}},5365:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>i,TN:()=>d});var a=s(5155);s(2115);var l=s(2085),r=s(9434);let n=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...l}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,r.cn)(n({variant:s}),t),...l})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,r.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}},5525:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7403:(e,t,s)=>{Promise.resolve().then(s.bind(s,1723))},9409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>u,eb:()=>m,gC:()=>x,l6:()=>o,yv:()=>c});var a=s(5155);s(2115);var l=s(83),r=s(6474),n=s(5196),i=s(7863),d=s(9434);function o(e){let{...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,a.jsx)(l.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:s="default",children:n,...i}=e;return(0,a.jsxs)(l.l9,{"data-slot":"select-trigger","data-size":s,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[n,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(r.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:s,position:r="popper",...n}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(p,{})]})})}function m(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(l.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(n.A,{className:"size-4"})})}),(0,a.jsx)(l.p4,{children:s})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(l.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(i.A,{className:"size-4"})})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(l.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(r.A,{className:"size-4"})})}}},e=>{e.O(0,[785,882,412,209,441,964,358],()=>e(e.s=7403)),_N_E=e.O()}]);